co_telegram_ui_package:
  homeassistant:
    customize:
      automation.co_telegram_ui_main:
        friendly_name: –¢–µ–ª–µ–≥—Ä–∞–º–º UI | –ö–æ—Ä–∏–¥–æ—Ä

  automation:
    - id: co_telegram_ui_main
      alias: co_telegram_ui_main
      initial_state: true
      trigger:
        - platform: event
          event_type: telegram_callback
          event_data: {}
      action:
        - choose:
            - conditions:
                - condition: template
                  value_template: "{{ trigger.event.data.command == '/corridor_control' }}"
              sequence:
                - service: telegram_bot.delete_message
                  data_template:
                    message_id: "{{ trigger.event.data.message.message_id }}"
                    chat_id: "{{ trigger.event.data.chat_id }}"
                - service: telegram_bot.send_message
                  data:
                    target: "{{ trigger.event.data.chat_id }}"
                    message: &msg_corridor |
                      *–ö–æ—Ä–∏–¥–æ—Ä :*
                      {{'\U0001F6AA'}} –í—Ö–æ–¥–Ω–∞—è –¥–≤–µ—Ä—å (–û—Å–Ω–æ–≤–Ω–æ–π –∑–∞–º–æ–∫) - {% if is_state('binary_sensor.0x00158d0003a44095_state', 'on') %} –û—Ç–∫—Ä—ã—Ç {% else %} –ó–∞–∫—Ä—ã—Ç {% endif %}
                      {{'\U0001F6AA'}} –í—Ö–æ–¥–Ω–∞—è –¥–≤–µ—Ä—å (–î–æ–ø. –∑–∞–º–æ–∫) - {% if is_state('binary_sensor.0x00158d0003a44095_reverse', 'on') %} –û—Ç–∫—Ä—ã—Ç {% else %} –ó–∞–∫—Ä—ã—Ç {% endif %}
                    inline_keyboard: &keyb_corridor
                      - '{{''\U0001F4A1''}} –û—Å–Ω–æ–≤–Ω–æ–π —Å–≤–µ—Ç - {% if is_state(''light.yeelight_450c_1'', ''off'')%}{{''üî¥''}}{% else %}{{''üü¢''}}{% endif %}:/corridor_toggle_main_ligth , {{''\U0001F4A1''}} –ù–æ—á–Ω–æ–π —Å–≤–µ—Ç - {% if is_state(''light.yeelight_450c_1_ambilight'', ''off'')%}{{''üî¥''}}{% else %}{{''üü¢''}}{% endif %}:/corridor_toggle_night_ligth'
                      - '{{''\U0001F4A1''}} –î–æ–ø. —Å–≤–µ—Ç - {% if is_state(''light.wiz_ceiling_corridor'', ''off'')%}{{''üî¥''}}{% else %}{{''üü¢''}}{% endif %}:/corridor_toggle_additional_main_ligth , {{''\U0001F4A1''}} –ù–æ—á–Ω–∏–∫ - {% if is_state(''light.xiaomi_gateway_001_light'', ''off'')%}{{''üî¥''}}{% else %}{{''üü¢''}}{% endif %}:/corridor_toggle_additional_night_ligth'
                      - '{{''\U000021A9''}} –í–µ—Ä–Ω—É—Ç—å—Å—è:/menu_back , {{''\U000021AA''}} –û–±–Ω–æ–≤–∏—Ç—å:/corridor_control'
            - conditions:
                - condition: template
                  value_template: "{{ trigger.event.data.command == '/corridor_toggle_main_ligth' }}"
              sequence:
                - service: light.toggle
                  entity_id: light.yeelight_450c_1
                - delay:
                    milliseconds: 500
                - service: telegram_bot.answer_callback_query
                  data:
                    callback_query_id: "{{ trigger.event.data.id }}"
                    message: |
                      {{"\U0001F4A1"}} –û—Å–Ω–æ–≤–Ω–æ–π —Å–≤–µ—Ç - {% if is_state('light.yeelight_450c_1', 'on') %} –í–∫–ª—é—á–µ–Ω {% else %} –í—ã–∫–ª—é—á–µ–Ω {% endif %}
                - service: telegram_bot.delete_message
                  data_template:
                    message_id: "{{ trigger.event.data.message.message_id }}"
                    chat_id: "{{ trigger.event.data.chat_id }}"
                - service: telegram_bot.send_message
                  data:
                    target: "{{ trigger.event.data.chat_id }}"
                    message: *msg_corridor
                    inline_keyboard: *keyb_corridor
            - conditions:
                - condition: template
                  value_template: "{{ trigger.event.data.command == '/corridor_toggle_night_ligth' }}"
              sequence:
                - service: light.toggle
                  entity_id: light.yeelight_450c_1_ambilight
                - delay:
                    milliseconds: 500
                - service: telegram_bot.answer_callback_query
                  data:
                    callback_query_id: "{{ trigger.event.data.id }}"
                    message: |
                      {{"\U0001F4A1"}} –ù–æ—á–Ω–æ–π —Å–≤–µ—Ç - {% if is_state('light.yeelight_450c_1_ambilight', 'on') %} –í–∫–ª—é—á–µ–Ω {% else %} –í—ã–∫–ª—é—á–µ–Ω {% endif %}
                - service: telegram_bot.delete_message
                  data_template:
                    message_id: "{{ trigger.event.data.message.message_id }}"
                    chat_id: "{{ trigger.event.data.chat_id }}"
                - service: telegram_bot.send_message
                  data:
                    target: "{{ trigger.event.data.chat_id }}"
                    message: *msg_corridor
                    inline_keyboard: *keyb_corridor

            - conditions:
                - condition: template
                  value_template: "{{ trigger.event.data.command == '/corridor_toggle_additional_main_ligth' }}"
              sequence:
                - service: light.toggle
                  entity_id: light.wiz_ceiling_corridor
                - delay:
                    milliseconds: 500
                - service: telegram_bot.answer_callback_query
                  data:
                    callback_query_id: "{{ trigger.event.data.id }}"
                    message: |
                      {{"\U0001F4AC"}} –°–≤–µ—Ç –Ω–∞–¥ –≤–∞–Ω–Ω–æ–π –∏ —Ç—É–∞–ª–µ—Ç–æ–º - {% if is_state('light.wiz_ceiling_corridor', 'on') %} –í–∫–ª—é—á–µ–Ω {% else %} –í—ã–∫–ª—é—á–µ–Ω {% endif %}
                - service: telegram_bot.delete_message
                  data_template:
                    message_id: "{{ trigger.event.data.message.message_id }}"
                    chat_id: "{{ trigger.event.data.chat_id }}"
                - service: telegram_bot.send_message
                  data:
                    target: "{{ trigger.event.data.chat_id }}"
                    message: *msg_corridor
                    inline_keyboard: *keyb_corridor

            - conditions:
                - condition: template
                  value_template: "{{ trigger.event.data.command == '/corridor_toggle_additional_night_ligth' }}"
              sequence:
                - service: light.toggle
                  entity_id: light.xiaomi_gateway_001_light
                - delay:
                    milliseconds: 500
                - service: telegram_bot.answer_callback_query
                  data:
                    callback_query_id: "{{ trigger.event.data.id }}"
                    message: |
                      {{"\U0001F4AC"}} –ù–æ—á–Ω–∏–∫ –≤ –∫–æ—Ä–∏–¥–æ—Ä–µ - {% if is_state('light.xiaomi_gateway_001_light', 'on') %} –í–∫–ª—é—á–µ–Ω {% else %} –í—ã–∫–ª—é—á–µ–Ω {% endif %}
                - service: telegram_bot.delete_message
                  data_template:
                    message_id: "{{ trigger.event.data.message.message_id }}"
                    chat_id: "{{ trigger.event.data.chat_id }}"
                - service: telegram_bot.send_message
                  data:
                    target: "{{ trigger.event.data.chat_id }}"
                    message: *msg_corridor
                    inline_keyboard: *keyb_corridor
