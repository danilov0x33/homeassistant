ha_telegram_ui_package:
  homeassistant:
    customize:
      automation.ha_telegram_ui_main:
        friendly_name: –¢–µ–ª–µ–≥—Ä–∞–º–º UI | –ó–∞–ª

  automation:
    - id: ha_telegram_ui_main
      alias: ha_telegram_ui_main
      trigger:
        - platform: event
          event_type: telegram_callback
          event_data: {}
      action:
        - choose:
            - conditions:
                - condition: template
                  value_template: "{{ trigger.event.data.command == '/hall_control' }}"
              sequence:
                - service: telegram_bot.delete_message
                  data_template:
                    message_id: "{{ trigger.event.data.message.message_id }}"
                    chat_id: "{{ trigger.event.data.chat_id }}"
                - service: telegram_bot.send_message
                  data:
                    target: "{{ trigger.event.data.chat_id }}"
                    message: &msg_hall |
                      *–ó–∞–ª :*
                      {{'\U0001F6AA'}} –û–∫–Ω–æ - {% if is_state('binary_sensor.0x00158d000123129b_contact', 'on') %} –û—Ç–∫—Ä—ã—Ç–æ {% else %} –ó–∞–∫—Ä—ã—Ç–æ {% endif %}
                      {{'\U0001F321'}} - {{ states('sensor.0x00124b00252193c2_temperature') }} ¬∞C, {{'\U0001F4A7'}} - {{ states('sensor.0x00124b00252193c2_humidity') }} %, {{'üí®'}} - {{ states('sensor.0xa4c1389466b02c9b_co2') }} CO2
                    inline_keyboard: &keyb_hall
                      - '{{''\U0001F4A1''}} –û—Å–Ω–æ–≤–Ω–æ–π —Å–≤–µ—Ç - {% if is_state(''light.yeelight_arwen_550c'', ''off'')%}{{''üî¥''}}{% else %}{{''üü¢''}}{% endif %}:/hall_toggle_main_ligth , {{''\U0001F4A1''}} –ù–æ—á–Ω–æ–π —Å–≤–µ—Ç - {% if is_state(''light.yeelight_arwen_550c_ambilight'', ''off'')%}{{''üî¥''}}{% else %}{{''üü¢''}}{% endif %}:/hall_toggle_night_ligth'
                      - '{{''\U0001F4FA''}} TV - {% if is_state(''media_player.samsung_tv'', ''off'')%}{{''üî¥''}}{% else %}{{''üü¢''}}{% endif %}:/hall_toggle_tv , {{''\U0001F50C''}} 3–î –ø—Ä–∏–Ω—Ç–µ—Ä - {% if is_state(''switch.0xa4c13826691e389b'', ''off'')%}{{''üî¥''}}{% else %}{{''üü¢''}}{% endif %}:/hall_toggle_3d_print'
                      - "{{'üì∑'}} –ü–æ–ª—É—á–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å –∫–∞–º–µ—Ä—ã:/hall_take_photo"
                      - '{{''\U000021A9''}} –í–µ—Ä–Ω—É—Ç—å—Å—è:/menu_back , {{''\U000021AA''}} –û–±–Ω–æ–≤–∏—Ç—å:/hall_control'
            - conditions:
                - condition: template
                  value_template: "{{ trigger.event.data.command == '/hall_toggle_main_ligth' }}"
              sequence:
                - service: light.toggle
                  entity_id: light.yeelight_arwen_550c
                - delay:
                    milliseconds: 500
                - service: telegram_bot.answer_callback_query
                  data:
                    callback_query_id: "{{ trigger.event.data.id }}"
                    message: |
                      {{"\U0001F4AC"}} –û—Å–Ω–æ–≤–Ω–æ–π —Å–≤–µ—Ç - {% if is_state('light.yeelight_arwen_550c', 'on') %} –í–∫–ª—é—á–µ–Ω {% else %} –í—ã–∫–ª—é—á–µ–Ω {% endif %}
                - service: telegram_bot.delete_message
                  data_template:
                    message_id: "{{ trigger.event.data.message.message_id }}"
                    chat_id: "{{ trigger.event.data.chat_id }}"
                - service: telegram_bot.send_message
                  data:
                    target: "{{ trigger.event.data.chat_id }}"
                    message: *msg_hall
                    inline_keyboard: *keyb_hall
            - conditions:
                - condition: template
                  value_template: "{{ trigger.event.data.command == '/hall_toggle_night_ligth' }}"
              sequence:
                - service: light.toggle
                  entity_id: light.yeelight_arwen_550c_ambilight
                - delay:
                    milliseconds: 500
                - service: telegram_bot.answer_callback_query
                  data:
                    callback_query_id: "{{ trigger.event.data.id }}"
                    message: |
                      {{"\U0001F4AC"}} –ù–æ—á–Ω–æ–π —Å–≤–µ—Ç - {% if is_state('light.yeelight_arwen_550c_ambilight', 'on') %} –í–∫–ª—é—á–µ–Ω {% else %} –í—ã–∫–ª—é—á–µ–Ω {% endif %}
                - service: telegram_bot.delete_message
                  data_template:
                    message_id: "{{ trigger.event.data.message.message_id }}"
                    chat_id: "{{ trigger.event.data.chat_id }}"
                - service: telegram_bot.send_message
                  data:
                    target: "{{ trigger.event.data.chat_id }}"
                    message: *msg_hall
                    inline_keyboard: *keyb_hall
            - conditions:
                - condition: template
                  value_template: "{{ trigger.event.data.command == '/hall_toggle_tv' }}"
              sequence:
                - service: media_player.toggle
                  entity_id: media_player.samsung_tv
                - delay:
                    milliseconds: 500
                - service: telegram_bot.answer_callback_query
                  data:
                    callback_query_id: "{{ trigger.event.data.id }}"
                    message: |
                      {{"\U0001F4AC"}} TV - {% if is_state('media_player.samsung_tv', 'on') %} –í–∫–ª—é—á–µ–Ω {% else %} –í—ã–∫–ª—é—á–µ–Ω {% endif %}
                - service: telegram_bot.delete_message
                  data_template:
                    message_id: "{{ trigger.event.data.message.message_id }}"
                    chat_id: "{{ trigger.event.data.chat_id }}"
                - service: telegram_bot.send_message
                  data:
                    target: "{{ trigger.event.data.chat_id }}"
                    message: *msg_hall
                    inline_keyboard: *keyb_hall
            - conditions:
                - condition: template
                  value_template: "{{ trigger.event.data.command == '/hall_toggle_3d_print' }}"
              sequence:
                - service: switch.toggle
                  entity_id: switch.0xa4c13826691e389b
                - delay:
                    milliseconds: 500
                - service: telegram_bot.answer_callback_query
                  data:
                    callback_query_id: "{{ trigger.event.data.id }}"
                    message: |
                      {{"\U0001F4AC"}} –†–æ–∑–µ—Ç–∫–∞ - {% if is_state('switch.0xa4c13826691e389b', 'on') %} –í–∫–ª—é—á–µ–Ω {% else %} –í—ã–∫–ª—é—á–µ–Ω {% endif %}
                - service: telegram_bot.delete_message
                  data_template:
                    message_id: "{{ trigger.event.data.message.message_id }}"
                    chat_id: "{{ trigger.event.data.chat_id }}"
                - service: telegram_bot.send_message
                  data:
                    target: "{{ trigger.event.data.chat_id }}"
                    message: *msg_hall
                    inline_keyboard: *keyb_hall
            # - conditions:
            #     - condition: template
            #       value_template: "{{ trigger.event.data.command == '/hall_toggle_conditioner' }}"
            #   sequence:
            #     - service: switch.toggle
            #       entity_id: switch.air_conditioner_01_power
            #     - delay:
            #         milliseconds: 500
            #     - service: telegram_bot.answer_callback_query
            #       data:
            #         callback_query_id: "{{ trigger.event.data.id }}"
            #         message: |
            #           {{"\U0001F4A8"}} –ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä - {% if is_state('switch.air_conditioner_01_power', 'on') %} –í–∫–ª—é—á–µ–Ω {% else %} –í—ã–∫–ª—é—á–µ–Ω {% endif %}
            #     - service: telegram_bot.delete_message
            #       data_template:
            #         message_id: "{{ trigger.event.data.message.message_id }}"
            #         chat_id: "{{ trigger.event.data.chat_id }}"
            #     - service: telegram_bot.send_message
            #       data:
            #         target: "{{ trigger.event.data.chat_id }}"
            #         message: *msg_hall
            #         inline_keyboard: *keyb_hall

            # –§–æ—Ç–æ —Å –∫–∞–º–µ—Ä—ã
            - conditions:
                - condition: template
                  value_template: "{{ trigger.event.data.command == '/hall_take_photo' }}"
              sequence:
                - service: camera.snapshot
                  target:
                    entity_id: camera.ty2_j23903450
                  data:
                    filename: "/config/www/downloads/camera/ty2_j23903450_last.jpg"
                - service: telegram_bot.send_photo
                  data_template:
                    target: !secret telegram_danilov_info_group_id
                    file: "/config/www/downloads/camera/ty2_j23903450_last.jpg"
                - delay:
                    milliseconds: 500
                - service: telegram_bot.answer_callback_query
                  data:
                    callback_query_id: "{{ trigger.event.data.id }}"
                    message: "–ì–æ—Ç–æ–≤–æ"
                - service: telegram_bot.delete_message
                  data_template:
                    message_id: "{{ trigger.event.data.message.message_id }}"
                    chat_id: "{{ trigger.event.data.chat_id }}"
                - service: telegram_bot.send_message
                  data:
                    target: "{{ trigger.event.data.chat_id }}"
                    message: *msg_hall
                    inline_keyboard: *keyb_hall
